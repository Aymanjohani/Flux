#!/bin/bash
# Flux-Lite Memory System CLI Wrapper
# Loads OPENAI_API_KEY from OpenClaw config for embeddings

set -e

# Extract OpenAI API key from OpenClaw config
if [ -z "$OPENAI_API_KEY" ]; then
    OPENAI_API_KEY=$(node -e "try{const c=require('/root/.openclaw/openclaw.json');console.log(c.env.vars.OPENAI_API_KEY||'')}catch(e){}" 2>/dev/null)
fi

if [ -z "$OPENAI_API_KEY" ]; then
    echo "‚ùå Error: OPENAI_API_KEY not found in env or OpenClaw config"
    exit 1
fi

export OPENAI_API_KEY

# Get the directory where this script is located
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Run the memory engine
node "$SCRIPT_DIR/memory_engine.js" "$@"
